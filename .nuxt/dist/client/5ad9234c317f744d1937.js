(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{328:function(e,t,r){"use strict";r.r(t);r(12),r(7),r(27),r(25);var n,o=r(2),c={data:function(){return{account_type:"",loading:!1,formData:{fullname:"",email:"",phone:""},ruleForm:{fullname:[{type:"string",required:!0,message:"Quý khách vui lòng nhập Họ và Tên."}],email:[{type:"email",required:!0}],phone:[{type:"string",min:10,max:10,message:"Số điện thoại không hợp lệ."}],gender:[{type:"string",required:!0,message:"Chọn giới tính"}],date_of_birth:[{type:"number",required:!0,message:"Quý khách cần nhập thông tin ngày sinh."}]},vr_show:!1,crawl_account:[],vr:{username:"",password:"",limit:"500"},vr_form:{username:[{type:"string",required:!0,message:"Quý khách vui lòng nhập username"}],password:[{type:"string",required:!0,message:"Quý khách vui lòng nhập password"}]},vr_loading:!1,vetc_show:!1,vetc:{username:"",password:"",limit:"500"},vetc_form:{username:[{type:"string",required:!0,message:"Quý khách vui lòng nhập username"}],password:[{type:"string",required:!0,message:"Quý khách vui lòng nhập password"}]},vetc_loading:!1}},created:(n=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.post("/api/account/permission/admin");case 2:if(!e.sent.data.error){e.next=7;break}this.$router.push("/"),e.next=9;break;case 7:return e.next=9,this.InIt();case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),computed:{vr_account:function(){return this.crawl_account.filter((function(e){return"vr"===e.type}))},vetc_account:function(){return this.crawl_account.filter((function(e){return"vetc"===e.type}))}},methods:{InIt:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.crawl(),e.RefreshInfo()]);case 2:case"end":return t.stop()}}),t)})))()},wait:function(time){return new Promise((function(e){setTimeout((function(){e(time)}),time)}))},crawl:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/api/crawl");case 2:return r=t.sent,data=r.data,e.crawl_account=data,t.next=7,e.wait(1e3);case 7:return t.next=9,e.crawl();case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t)})))()},RefreshInfo:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/api/account/info");case 3:if(r=t.sent,!(data=r.data).error){t.next=7;break}throw data.error;case 7:return t.abrupt("return",e.formData=data);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",e.$message({type:"error",message:t.t0}));case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},add_vr:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(r=e).$refs.vr.validate(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,o,c,l,d,m,v,h,f,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=29;break}return r.vr_loading=!0,e.prev=2,(n=r.vr).limit=parseInt(n.limit),e.next=7,r.$axios.post("/api/crawl/add-vr",n);case 7:if(o=e.sent,c=o.data,l=c.username,d=c.id,m=c.type,v=c.status,h=c.error,f=c.limit,w=c.scanned,!h){e.next=18;break}throw h;case 18:r.crawl_account.push({username:l,type:m,status:v,id:d,limit:f,scanned:w,active:!0}),r.cancelVR(),r.$message({type:"success",message:"Quý khách thêm tài khoản VR thành công !"}),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(2),r.$message({type:"error",message:e.t0});case 26:r.vr_loading=!1,e.next=30;break;case 29:return e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})))()},add_vetc:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(r=e).$refs.vetc.validate(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,o,c,l,d,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=26;break}return r.vetc_loading=!0,e.prev=2,r.vetc.limit=parseInt(r.vetc.limit),e.next=6,r.$axios.post("/api/crawl/add-vetc",r.vetc);case 6:if(n=e.sent,o=n.data,c=o.username,l=o.type,d=o.id,m=o.status,!(v=o.error)){e.next=15;break}throw v;case 15:r.crawl_account.push({username:c,type:l,status:m,id:d}),r.cancelVETC(),r.$message({type:"success",message:"Quý khách thêm tài khoản VETC thành công !"}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),r.$message({type:"error",message:e.t0});case 23:r.vetc_loading=!1,e.next=27;break;case 26:return e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})))()},cancelVR:function(){this.vr_show=!1,this.vr.username="",this.vr.password=""},cancelVETC:function(){this.vetc_show=!1,this.vetc.username="",this.vetc.password=""},remove_crawl:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$axios.delete("/api/crawl/"+e.id);case 2:return n=r.sent,n.data,r.next=6,t.$axios.post("/api/crawl/remove-config",{username:e.username});case 6:t.crawl_account=t.crawl_account.filter((function(t){return t.id!==e.id})),t.$message({type:"warning",message:"Đã xóa tài khoản "+e.username+" !"});case 8:case"end":return r.stop()}}),r)})))()}}},l=r(39),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",[r("el-col",{attrs:{span:24,offset:0}},[r("el-tabs",{attrs:{type:"border-card","tab-position":"top",closable:!1,addable:!1,editable:!1,stretch:!1},on:{"tab-click":function(e){}},model:{value:e.account_type,callback:function(t){e.account_type=t},expression:"account_type"}},[r("el-tab-pane",{attrs:{label:"Liên kết"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{align:"left",span:12,offset:0}},[r("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[r("div",{attrs:{slot:"header"},slot:"header"},[e._v("\n\t\t\t\t\t\t\t\tĐăng kiểm VR\n\t\t\t\t\t\t\t")]),e._v(" "),r("div",{staticStyle:{padding:"14px"}},[e._l(e.vr_account,(function(data,t){return r("el-dropdown",{key:t,staticStyle:{"margin-left":"7px"},attrs:{type:data.scanned!==data.limit&&data.active?"success":"danger",placement:"bottom-end",size:"mini",trigger:"click","split-button":!0,"hide-on-click":!1},on:{command:e.remove_crawl}},[r("el-tooltip",{attrs:{effect:"dark",placement:"bottom-start"}},[r("div",{attrs:{slot:"content"},slot:"content"},[data.active?r("h4",[e._v("Limit: "+e._s(data.limit)+" "),r("br"),e._v(" Scanned: "+e._s(data.scanned))]):e._e(),e._v(" "),data.scanned===data.limit||data.active?e._e():r("h4",[e._v("Tài khoản này không truy cập được")])]),e._v(" "),r("span",[e._v("\n\t\t\t\t\t\t\t\t   "+e._s(data.username)+"\n\n\t\t\t\t\t\t\t\t  ")])]),e._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:data,icon:"",divided:!1,disabled:!1}},[e._v("Xóa")])],1)],1)})),e._v(" "),r("el-button",{attrs:{type:"primary",icon:"",loading:!1,plain:!0,round:!1,circle:!1,autofocus:!1,size:"mini",disabled:!1},on:{click:function(t){e.vr_show=!0}}},[e._v("+")])],2)])],1),e._v(" "),r("el-col",{attrs:{align:"left",span:12,offset:0}},[r("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[r("div",{attrs:{slot:"header"},slot:"header"},[e._v("\n\t\t\t\t\t\t\t\tThông tin cá nhân VETC\n\t\t\t\t\t\t\t")]),e._v(" "),r("div",{staticStyle:{padding:"14px"}},[e._l(e.vetc_account,(function(data,t){return r("el-dropdown",{key:t,staticStyle:{"margin-left":"7px"},attrs:{type:data.status?"success":"danger",placement:"bottom-end",size:"mini",trigger:"click","split-button":!0,"hide-on-click":!1},on:{command:e.remove_crawl}},[r("span",[e._v("\n\t\t\t\t\t\t\t\t   "+e._s(data.username)+"\n\t\t\t\t\t\t\t\t  ")]),e._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:data,icon:"",divided:!1,disabled:!1}},[e._v("Xóa")])],1)],1)})),e._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:0===e.vetc_account.length,expression:"vetc_account.length === 0"}],attrs:{type:"primary",icon:"",loading:!1,plain:!0,round:!1,circle:!1,autofocus:!1,size:"mini",disabled:!1},on:{click:function(t){e.vetc_show=!0}}},[e._v("+")])],2)])],1)],1)],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"Nhập thông tin tài khoản Đăng kiểm VR",visible:e.vr_show,center:!1,fullscreen:!1,top:"15vh",width:"30%"},on:{"update:visible":function(t){e.vr_show=t}}},[r("el-form",{ref:"vr",attrs:{rules:e.vr_form,model:e.vr,"status-icon":"","label-width":"auto","label-position":"top",inline:!1,disabled:!1,"inline-message":!1,"show-message":"","validate-on-rule-change":"",size:"small"}},[r("el-form-item",{attrs:{label:"Username",prop:"username",align:"left"}},[r("el-input",{attrs:{placeholder:"Tên đăng nhập",size:"small",clearable:"",type:"text",autosize:!1,disabled:!1,autocomplete:"off"},model:{value:e.vr.username,callback:function(t){e.$set(e.vr,"username",t)},expression:"vr.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Password",prop:"password",align:"left"}},[r("el-input",{attrs:{placeholder:"Mật khẩu",size:"small","show-password":"",disabled:!1,autocomplete:"off"},model:{value:e.vr.password,callback:function(t){e.$set(e.vr,"password",t)},expression:"vr.password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Số biển kiểm soát Quét VR:",prop:"limit",align:"left"}},[r("el-input",{attrs:{size:"small",clearable:"",type:"text",autosize:!1,disabled:!1,autocomplete:"off"},model:{value:e.vr.limit,callback:function(t){e.$set(e.vr,"limit",t)},expression:"vr.limit"}})],1)],1),e._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:e.cancelVR}},[e._v("Cancel")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.vr_loading,size:"small"},on:{click:e.add_vr}},[e._v("Confirm")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"Nhập tài khoản tra cứu VETC",visible:e.vetc_show,center:!1,fullscreen:!1,top:"15vh",width:"30%"},on:{"update:visible":function(t){e.vetc_show=t}}},[r("el-form",{ref:"vetc",attrs:{rules:e.vetc_form,model:e.vetc,"status-icon":"","label-width":"auto","label-position":"top",inline:!1,disabled:!1,"inline-message":!1,"show-message":"","validate-on-rule-change":"",size:"small"}},[r("el-form-item",{attrs:{label:"Username",prop:"username",align:"left"}},[r("el-input",{attrs:{placeholder:"Tên đăng nhập",size:"small",clearable:"",type:"text",autosize:!1,disabled:!1,autocomplete:"off"},model:{value:e.vetc.username,callback:function(t){e.$set(e.vetc,"username",t)},expression:"vetc.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Password",prop:"password",align:"left"}},[r("el-input",{attrs:{placeholder:"Mật khẩu",size:"small","show-password":"",disabled:!1,autocomplete:"off"},model:{value:e.vetc.password,callback:function(t){e.$set(e.vetc,"password",t)},expression:"vetc.password"}})],1)],1),e._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:e.cancelVETC}},[e._v("Cancel")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.vetc_loading,size:"small"},on:{click:e.add_vetc}},[e._v("Confirm")])],1)],1)],1)}),[],!1,null,"07526845",null);t.default=component.exports}}]);